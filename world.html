<!DOCTYPE html>
<html>
<head>
	<!-- Come back to this later. -->
	<title>Erintuitive's chatroom</title>
	<link rel="stylesheet" type="text/css" href="/assets/css/style.css"/>
	<meta property="og:url"           content="https://erintuitive6.herokuapp.com/human2.html" />
	<meta property="og:type"          content="website" />
	<meta property="og:title"         content="Erintuitive" />
	<meta property="og:description"   content="The Psychic who Reads Your Personality instead of Your Future" />
	<meta property="og:image"         content="https://erintuitive6.herokuapp.com/assets/img/inRoom.jpg" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body id="worldBody">
<div id="inworld">
	<img src="/assets/svg/fire_room.svg" alt="torchlight" width="745px" height="440px" style="position: absolute; left: 7px; top: 0;"/>
	<div id="staging" style="position: absolute; left: 7px; top: 0;"></div>
	<div id="staging2" style="position: absolute; left: 7px; top: 0; margin-left: 1000px;"></div>
	<img alt="drawing" id="myDrawing" width="700px" height="450px" style="border:1px solid #000000; margin-left: 690px;" src=""/>
	<canvas id="bounds" width="800" height="740" style="position: fixed; left: 0; top: 0;"></canvas>
	<div id="playersDiv" style="position: fixed; top: 0; left: 0;"></div>
	<!-- message form -->
	<div id="form">
		<ul id="messages" style="word-break: break-all; word-wrap: break-word;"></ul>
	</div>
	<textarea id="m" rows="5" cols="34" value=""></textarea><button id="n">Send</button>
</div>
<button id="sendAvatar" onclick="sendAvatar()" style="padding: 10px">Send your avatar to the database!</button>
<div id="menuSuggestions" height="430">
	<font color="purple"><br>You have been <br>logged out of <br>chat due to messaging<br> inactivity. You can <br>still play a <br>minigame or rejoin<br> the room."</font><br>
	<!-- include menu sugggestions here as images -->
</div>
<div id="drawingButton"><button onclick="drawing()">Draw a picture for me to interpret!</button><br>
	<!-- come back to this later -->
	<!-- <font color="white" style="font-size: 26px;">Request a reading by Erintuitive!<br>Tweet "reading" to @masterer</font> -->
	<!-- <form style="position: fixed; top: 450px; left: 450px;" id="payment" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
		<input type="hidden" name="cmd" value="_s-xclick">
		<input type="hidden" name="hosted_button_id" value="PRUWLY3PGJUFA">
		<table>
		<tr><td><input type="hidden" name="on0" value="Tip jar payment options">Tip jar payment options</td></tr><tr><td><select name="os0">
			<option value="Option1:">Option1: $5.00 USD</option>
			<option value="Option2:">Option2: $10.00 USD</option>
			<option value="Option3:">Option3: $20.00 USD</option>
		</select> </td></tr>
		</table>
		<input type="hidden" name="currency_code" value="USD">
		<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
		<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
	</form> -->
</div><!--
<form style="position: fixed; top: 450px; left: 450px;" id="payment" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
	<input type="hidden" name="cmd" value="_s-xclick">
	<input type="hidden" name="hosted_button_id" value="PRUWLY3PGJUFA">
	<table>
	<tr><td><input type="hidden" name="on0" value="Tip jar payment options"><font color="white">Payment totally optional! (but greatly appreciated)</font></td></tr><tr><td><select name="os0">
		<option value="Option1:">Option1: $5.00 USD</option>
		<option value="Option2:">Option2: $10.00 USD</option>
		<option value="Option3:">Option3: $20.00 USD</option>
	</select> </td></tr>
	</table>
	<input type="hidden" name="currency_code" value="USD">
	<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
	<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> -->
<div id="fb-root">Share on Facebook</div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = 'https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.12&appId=817064305070781&autoLogAppEvents=1';
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div style="position: fixed; top: 550px; left: 450px;">
	<div class="fb-share-button" data-href="https://erintuitive6.herokuapp.com" data-layout="button_count" data-size="large" data-mobile-iframe="true"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ferintuitive6.herokuapp.com%2F&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">Share</a></div>
	<a class="twitter-share-button"
	href="https://twitter.com/intent/tweet?text=I%20was%20read%20by%20%23Erintuitive%21"
	data-size="large"><font color="yellow">Tweet about this!</font></a>	
</div>
<div id="girlBody"></div>
<div id="girlArms"></div>
<img id="speech" alt="speech bubble" src="/assets/svg/speech.svg" height="270px">
<div bgcolor="white" id="allAvatars">Display of all created avatars.</div>
<!-- start embed scripts -->
<script src="/assets/js/socket.io.js"></script>
<script src="/assets/js/htmlgl.js"></script>
<script src="/assets/js/pixi.min.js"></script>
<script src="/assets/js/pixi.dom.js"></script>
<script src="/assets/js/jquery.js"></script>
<script src="/assets/js/dom-to-image.min.js"></script>
<script src="/assets/js/blob-util.min.js"></script>
<script src="/assets/js/TweenMax.min.js"></script>
<!-- end embed scripts -->
<script>
	var name = window.localStorage.getItem("name");
	$("#m").focus(function(){
		$(document).keyup(function(e){
			switch(e.which) {
				case 13:
				submit();
			}
		});
		$("#n").click(function(){
			submit();
		})
	});
	console.log(window.localStorage.getItem("drawing"));
	document.getElementById("myDrawing").setAttribute("src", window.localStorage.getItem("drawing"));
	//add link in message

	var app = new PIXI.Application();
	document.getElementById("staging").appendChild(app.view);
	app.stage.interactive = true;
	
	var container = new PIXI.Container();
	app.stage.addChild(container);
	
	var spriteSVGImage_room = "/assets/svg/fire_room.svg";
	var spriteSVGTexture_room = PIXI.Texture.fromImage(spriteSVGImage_room);
	var SpriteSVG_room = new PIXI.Sprite(spriteSVGTexture_room);
	container.addChild(SpriteSVG_room);
	
	var fireContainer = new PIXI.Container();
	app.stage.addChild(fireContainer);
	
	var spriteSVGImage = "/assets/svg/fire_room_torchlight.svg";
	var spriteSVGTexture = PIXI.Texture.fromImage(spriteSVGImage);
	var SpriteSVG = new PIXI.Sprite(spriteSVGTexture);
	fireContainer.addChild(SpriteSVG);
	
	var displacementSprite = new PIXI.Sprite.fromImage("/assets/img/displacement_map.jpg");
	var displacementFilter = new PIXI.filters.DisplacementFilter(displacementSprite);
	fireContainer.addChild(displacementSprite);
	
	var blurFilter = new PIXI.filters.BlurFilter();
	
	fireContainer.filters = [displacementFilter, blurFilter];
	fireContainer.y = 5;
	
	displacementFilter.scale.x = 25;
	displacementFilter.scale.y = -350;
	displacementFilter.rotation = 20;

	var personContainer = new PIXI.Container();
	app.stage.addChild(personContainer);
	personContainer.y = 0;
	personContainer.x = 0;

	var girlPushContainer = new PIXI.Container();
	app.stage.addChild(girlPushContainer);
	girlPushContainer.x = 1000;
	girlPushContainer.y = 0;

	var girlBodyContainer = new PIXI.Container();
	girlPushContainer.addChild(girlBodyContainer);
	var girlArmsContainer = new PIXI.Container();
	girlPushContainer.addChild(girlArmsContainer);

	var girlPushArms = `<svg id="girlPushArms" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200px" height="220px" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid meet" ><rect id="svgEditorBackground" x="0" y="0" width="1300" height="550" style="fill:none; stroke: none;"/><defs id="svgEditorDefs"><path id="svgEditorClosePathDefs" style="stroke:black;stroke-width:3.49px;fill:lightsalmon;"/><linearGradient gradientUnits="objectBoundingBox" id="lrgd2-e1-repeat" spreadMethod="repeat" x1="20%" x2="40%" y1="0%" y2="0%"><stop offset="0%" stop-color="lightblue"/><stop offset="100%" stop-color="#ef5b2b"/></linearGradient><linearGradient gradientTransform="rotate(90)" gradientUnits="objectBoundingBox" id="lgrd2-d-reflect" spreadMethod="reflect" x1="0%" x2="5%" y1="0%" y2="5%"><stop offset="0%" stop-color="#e20709" stop-opacity="0.8"/><stop offset="5%" stop-color="#9ad346" stop-opacity="1"/></linearGradient><linearGradient gradientTransform="skewX(-45)" gradientUnits="objectBoundingBox" id="lgrd2-c-repeat" spreadMethod="repeat" x1="0%" x2="5%" y1="0%" y2="0%"><stop offset="5%" stop-color="red" stop-opacity="0.8"/><stop offset="75%" stop-color="yellow" stop-opacity="1"/></linearGradient><linearGradient gradientTransform="rotate(90)" gradientUnits="objectBoundingBox" id="lgrd4-a" spreadMethod="repeat" x1="0%" x2="15%" y1="0%" y2="5%"><stop offset="5%" stop-color="#e20709" stop-opacity="0.8"/><stop offset="30%" stop-color="#9ad346" stop-opacity="1"/><stop offset="60%" stop-color="#bcd346" stop-opacity="0.8"/><stop offset="90%" stop-color="#e20709" stop-opacity="0.8"/></linearGradient></defs><ellipse id="e6_ellipse" cx="203.03472900394536" cy="317.02777099604737" style="fill:lightsalmon;stroke:black;stroke-width:0px;" rx="28" ry="19"/><ellipse id="e7_ellipse" cx="222.98426818842663" cy="315.0421752929972" style="fill:lightsalmon;stroke:black;stroke-width:0px;" rx="28" ry="19"/><ellipse id="e10_ellipse" cx="248.2004852294688" cy="313.04934692378305" style="fill:lightsalmon;stroke:black;stroke-width:0px;" rx="28" ry="19"/><path d="M320.0347290039,320.078225229c10.92573822899999,0.9772787072000142,20.8250811227,-2.441803874199991,25,-9c4.174918877399989,-6.558196125899997,12.388486751914627,-15.775778948191771,9,-36c2.5682667629000093,-9.303506275000018,1.2045775335000144,-34.51615778140001,-2,-41c-3.2045775335000144,-6.483842218700005,-11.016766773100017,-16.38149208659999,-11,-13c0.016766773100016508,3.3814920865000033,6.067945325460869,89.06731333204652,4.999999999960892,5.000000000046413c-9.067945325499977,2.9326866678999863,-11.45178609300001,35.039092598699966,-9.97837675730068,43.05045423286319c-1.5698371495993229,-12.089546831563212,1.8575679647398147,-26.563628896409597,1.9783767573397881,-32.0504542329096c0.1208087926000303,-5.486825336599992,0.9002248204000125,-2.8922347433000084,0,-5c-0.9002248203000249,-2.1077652568000076,-8.053159409800003,-12.896021528600016,-10,-9c-5.918009599868924,93.2473242489666,5.009462369099992,31.959839334700007,-11.935130272053698,38.978376757376566c0.925667903053693,1.0617839079234273,-6.990607956946292,57.04434453542342,3.935130272053698,58.021623242623434Z" style="stroke:black;fill:lightsalmon;stroke-width:3.49px;" id="e26_area3"/><path d="M268.027521256381,315.0998484714809c3.056086981100009,4.353333855100004,13.580685845500057,10.056487300599997,19,10c5.419314154599988,-0.05648730059999707,17.646484034600007,-2.980274502700013,20,-9c4.353515965360884,-27.019725497253603,2.8300856481000665,-28.0318503469,6.999999999999943,-32c4.169914351999978,-3.96814965319993,11.028957312200191,-18.746449968199954,9,-21c-2.028957312199964,-2.253550031799932,-0.7769220921998112,0.45104345670006296,-1,-1c-0.2230779077999614,-1.4510434567999937,-5.235008530499954,-9.799469138900008,-7,-8c-1.764991469399945,1.7994691388000206,-9.039821385999915,17.124749704800024,-7.999999999999943,15c1.0398213860000851,-2.124749704800024,5.5653473876000135,-28.891823719200033,6,-35c0.4346526123999297,-6.108176280900011,-5.938815040799966,-17.290550921900035,-9,-17c-3.061184959199977,0.29055092190003506,-5.016587277699955,0.39655969150001624,-5,2c0.016587277799999356,1.6034403083999678,0.5643307495000727,8.638737042000002,-1,10c-1.564330749499959,1.3612629579000668,-5.030704426299906,0.7283569014999784,-6,4c-0.9692955735999931,3.2716430985000216,-3.58306572609996,14.968170588800035,-3,21c0.5830657262000614,6.031829411100034,-0.1815828292999413,25.030858433800063,-5,28c-4.818417170699945,2.969141566200051,-15.840011930300022,7.116403059700019,-18,12c-26.15998806973903,-11.116403059653635,-1.0560869811000089,16.646666144899996,2,21Z" style="stroke:black;fill:lightsalmon;stroke-width:2.92px;" id="e1_area3"/><ellipse id="e1_ellipse" cx="256.7392883300407" cy="309.08532714843676" style="fill:lightsalmon;stroke:black;stroke-width:0px;" rx="28" ry="19"/></svg>`;
	var girlPushBody = `<svg id="girlPushBody" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200px" height="220px" viewBox="0 0 500 550" preserveAspectRatio="xMidYMid meet" ><rect id="svgEditorBackground" x="0" y="0" width="1300" height="550" style="fill:none; stroke: none;"/><defs id="svgEditorDefs"><path id="svgEditorClosePathDefs" style="stroke:black;stroke-width:3.49px;fill:lightsalmon;"/><linearGradient gradientUnits="objectBoundingBox" id="lrgd2-e1-repeat" spreadMethod="repeat" x1="20%" x2="40%" y1="0%" y2="0%"><stop offset="0%" stop-color="lightblue"/><stop offset="100%" stop-color="#ef5b2b"/></linearGradient><linearGradient gradientTransform="rotate(90)" gradientUnits="objectBoundingBox" id="lgrd2-d-reflect" spreadMethod="reflect" x1="0%" x2="5%" y1="0%" y2="5%"><stop offset="0%" stop-color="#e20709" stop-opacity="0.8"/><stop offset="5%" stop-color="#9ad346" stop-opacity="1"/></linearGradient><linearGradient gradientTransform="skewX(-45)" gradientUnits="objectBoundingBox" id="lgrd2-c-repeat" spreadMethod="repeat" x1="0%" x2="5%" y1="0%" y2="0%"><stop offset="5%" stop-color="red" stop-opacity="0.8"/><stop offset="75%" stop-color="yellow" stop-opacity="1"/></linearGradient><linearGradient gradientTransform="rotate(90)" gradientUnits="objectBoundingBox" id="lgrd4-a" spreadMethod="repeat" x1="0%" x2="15%" y1="0%" y2="5%"><stop offset="5%" stop-color="#e20709" stop-opacity="0.8"/><stop offset="30%" stop-color="#9ad346" stop-opacity="1"/><stop offset="60%" stop-color="#bcd346" stop-opacity="0.8"/><stop offset="90%" stop-color="#e20709" stop-opacity="0.8"/></linearGradient></defs><g id="e3_group"><path d="M132.02029824989998,98.04219412059999c-12.91127285720006,22.189841661499997,-15.11258066540006,65.67726450229998,-19,81.99999237060004c-3.887419334600054,16.32272786829992,-11.940760004699996,34.45606771259992,-4,50.99999999999994c7.940760004699996,16.54393228729998,49.90398144599999,50.70172050239995,75,62.00000000000006c25.096018554099942,11.298279497600106,30.89569456606091,19.779901424646596,86.00001525876084,-1.9999999999536158c65.10432069273918,-20.77990142474664,101.72939852360003,-98.6961515726,78,-130.00000000000003c-14.729398523600025,-79.3038484274,-63.593770684560695,-80.7892434225464,-95.0000152587609,-90.9999923706464c-31.406244574200002,-10.21074894809999,-108.0887271428,5.810158338400015,-120.99999999999994,28Z" style="stroke: black; stroke-width:3.84px;fill:#FFA07A;" id="e2_area3"/><ellipse id="e3_ellipse" cx="204.02043151851487" cy="161.69453430175628" style="fill:black;stroke:black;stroke-width:1px;" rx="41" ry="10" transform="matrix(1 0 0 0.6 0 60.0111)"/><ellipse id="e4_ellipse" cx="303.02740478511646" cy="156.53591918945142" style="fill:black;stroke:black;stroke-width:1px;" rx="43" ry="11" transform="matrix(1 0 0 0.54 0 69.0128)"/><path d="M143.70503426749997,145.73413025610003c2.3473298748000104,-2.6471205237000106,23.129351318960886,10.700315552446426,23.00000000000003,9c-0.12935131890003504,6.299684447499999,-26.59574955550002,-2.7012639579999984,-25.00000000000003,-6c1.5957495555000207,-3.298736042099989,-0.347329874699966,-0.3528794764000054,2,-3Z" style="stroke:black;fill:black;stroke-width:1px;" id="e8_area3" transform="matrix(1 0 0 1 47.654 80.4162)"/><path d="M151.02750599734344,328.10951481284235c2.3692769168782775,-41.99816166961489,1.3830444671565374,-20.993471663851665,11.000000000156547,-35.0000000002517c-45.38304446703913,-36.05235791172049,112.33345834489995,-12.539295735999985,90.0000152587609,6.469721971760805c15.666556913960932,23.06957376433229,23.551750437682728,75.17939713870555,-6.000000000039108,85.87888788681698c-8.551750437778196,75.85170595561124,26.635053455839085,122.72056374376905,-12.000015258721788,124.65139014142244c-34.63506871459998,21.930826397699434,-109.71822158379999,28.415403071699416,-140,-3c54.71822158376085,-78.44650616589388,53.630723083082586,-135.18350650018385,53.9999999999217,-147.833058311267Z" style="stroke:black;fill:url(#lgrd2-d-reflect);stroke-width:3px;" id="e10_area3" transform="matrix(1 0 0 0.680401 0 99.2365)"/><path d="M103.03471374509999,449.0421864911999c-17.934968934339125,22.843479312546492,-29.26302000919999,25.29662468790002,-23.999999999999986,39c20.263020009260856,8.703375312046433,64.67481343729999,16.164532127800044,67.99999999996085,5.000000000046498c2.3251865626999972,-9.164532127899975,8.305837127399997,-16.91743366849994,16.000000000039137,-34.0000000000465c-26.305837127339117,-0.08256633155349391,-30.065031065739134,-1.8434793124534963,-60,-10Z" style="stroke:black;fill:lightsalmon;stroke-width:1.62px;" id="e21_area3"/><path d="M168.72987883191553,454.16785391882013c-17.93496893433911,22.843479312546492,-29.263020009199977,25.29662468790002,-24,39c5.263020009300021,13.703375312000048,64.6748134373,16.164532127800044,74,6c9.325186562699997,-10.164532127899975,2.30583712736086,-17.917433668453555,10,-35c-26.305837127339117,-0.08256633155349391,-30.065031065739134,-1.8434793124534963,-60,-10Z" style="stroke:black;fill:lightsalmon;stroke-width:1.54px;" id="e12_area3" transform="matrix(0.93671 -0.350106 0.350106 0.93671 -143.893 92.3884)"/><path d="M56.38339997895268,496.3299695429494c6.074478901100022,-14.744875361799984,15.929988151699987,-19.07690271680002,24.999999999999986,-26c9.070011848400014,-6.923097283199979,47.64060934309998,-8.10501067140001,56,1c8.359390657000006,9.10501067140001,10.518931585199994,25.3837357461,4.999999999921727,43.00000000009294c-37.51893158506087,-5.3837357462464865,-92.07447890092172,-3.255124638292841,-87.30675356218646,-15.12034808914558Z" style="stroke:black;fill:url(#lgrd4-a);stroke-width:0px;" id="e24_area3" transform="matrix(0.994571 -0.104061 0.104061 0.994571 -50.7477 13.8464)"/><polygon style="stroke:blue;fill:aqua;stroke-width:1.54px;" id="e28_polygon" points="169.028 44.0278 145.028 102.028 139.028 139.028 139.028 137.028 145.028 184.028 188.028 82.0278 223.028 149.028 228.028 81.0278 237.028 116.028 236.028 152.028 241.028 179.028 247.028 134.028 257.028 112.028 264.028 95.0278 262.028 79.0278 282.028 134.028 283.028 163.028 291.028 139.028 294.028 112.028 293.028 95.0278 319.028 134.028 363.028 164.028 413.028 172.028 351.028 130.028 351.028 127.028 331.028 101.028 285.028 69.0278 249.028 52.0278 194.028 53.0278 176.028 50.0278" /><polygon style="stroke:blue;fill:aqua;stroke-width:1.54px;" id="e29_polygon" points="98.0275 145.042 74.0275 211.042 65.0275 253.042 81.0275 314.042 97.0275 335.042 91.0275 253.042 103.028 298.042 124.028 322.042 114.028 280.042 138.028 301.042 129.028 273.042 147.028 283.042 145.028 270.042 112.028 243.042 113.028 241.042 102.028 218.042 104.028 220.042 107.028 195.042 127.028 119.042" /><polygon style="stroke:blue;fill:aqua;stroke-width:1.54px;" id="e5_polygon" points="160.028 60.0278 106.028 126.028 96.0278 149.028 92.0278 202.028 154.028 113.028" /></g><path d="M154.04914539258237,499.7943240180018c6.074478901100008,-14.744875361800041,15.929988151700002,-19.076902716800078,25,-26c9.070011848400043,-6.923097283200036,47.64060934310004,-8.10501067140001,56,1c8.359390657000006,9.10501067140001,10.51893158520005,25.3837357461,4.999999999921727,43.000000000092655c-37.51893158506084,-5.383735746246543,-92.07447890092169,-3.255124638292955,-85.99999999992173,-18.000000000092655Z" style="stroke:black;fill:url(#lgrd4-a);stroke-width:0px;" id="e4_area3" transform="matrix(0.98631 -0.164905 0.164905 0.98631 -84.6034 37.7049)"/></svg>`;

	document.getElementById("girlArms").innerHTML = girlPushArms;
	document.getElementById("girlBody").innerHTML = girlPushBody;

	var count = 0;
	
	//set user id
	//var userId = "local" + Math.random().toString();
	var d = new Date();
	var userId = d.getTime();
	var posX = 0;
	var posY = 0;
	var right = window.localStorage.getItem("avatarClothed_right");
	var left = window.localStorage.getItem("avatarClothed_left");
	var players = {};

	var socket = io.connect("/");
	function submit() {
		socket.emit("msg", $("#m").val(), name, userId);
		$("#m").val('');
	}
	function sendAvatar() {
		var uriMongoDB = 'mongodb://heroku_mq1nx7l4:heroku_mq1nx7l4@ds153835.mlab.com:53835/heroku_mq1nx7l4';
		socket.emit("mongo", uriMongoDB, right);
	}
	socket.on("mongo", function(element){
		var allAvatars = document.getElementById("allAvatars");
		allAvatars.innerHTML += element['thisAvatar'];
	});
	submitDrawing(window.localStorage.getItem("drawing"));
	function submitDrawing(dataUrl) {
		if(document.getElementById("myDrawing").getAttribute("src").length > 15){
			document.getElementById("myDrawing").style.visibility = 'visible';
			socket.emit("msg", '<a href="' + dataUrl + '">My drawing</a>', name, userId);
			setTimeout(function(){
				window.localStorage.removeItem("drawing");
			}, 60);
		}
		else {
			document.getElementById("myDrawing").style.visibility = 'hidden';
		}
	}
	var motionTime = false;
	socket.on("msgReturn", function(value, name2){
		if(value != "" && value != null){
			if(value.indexOf("/remove ") == 0){
				var nameValue = value.substr(8);
				for (player in players){
					//name
					if(players[player][4] == nameValue){
						socket.emit("removePlayer", player);
					}
				}
			}
			else {
				$("#messages").append("<font color='purple'>" + name2 + "</font>: " + value + "</li><br>");
			}
		}
		var chatWindow = document.getElementById("messages");
		chatWindow.scrollTop = chatWindow.scrollHeight;
	});
	setInterval(function(){
		socket.emit("afk", userId);
	}, 1000);
	socket.on("removePlayerReturn", function(id){
		var element = document.getElementById(id);
		var element2 = element.parentNode;
		element2.parentNode.removeChild(element2);
	});
	function drawing() {
		if(document.getElementById(userId) != null){
			socket.emit("removePlayer", userId);
			window.location.replace("/drawing");
		}
	}
	socket.on("afkReturn", function(id, afk){
		if(document.getElementById(userId) != null){
			var element = document.getElementById(userId);
			var elemName = userId + "afk";
			var elem = document.getElementById(elemName);
			if(id == userId){
				if(afk[`${id}`] <= 500) {
					elem.style.visibility = "hidden";
				}
				else if(afk[`${id}`] > 500){
					elem.style.visibility = "visible";
				}
				if(afk[`${id}`] > 2200){
					socket.emit("removePlayer", id);
					//$("#inworld").hide();
					$("#girlArms, #girlBody, #girlPushArms, #girlPushBody, #speech").css({'visibility': 'visible'});
					$("#menuSuggestions").css({'visibility': 'visible'});
					$("#m, #n").css({'visibility': 'hidden'});
					motionTime = true;
					//("body").css({'background-color': '#FECCFF'});
					
				}
			}
		}
	});
	fireContainer.addChild(SpriteSVG);
	var arms = 0;
	document.getElementById("bounds").onclick = function(e) {
		var xPosition = e.clientX;
		var yPosition = e.clientY - 190;
		console.log(xPosition, yPosition);
		socket.emit("updateId", userId, xPosition.toString() + "px", yPosition.toString() + "px");
	}
	socket.on("playerUpdate", function(id, x, y){
		players[id][2] = x;
		players[id][3] = y;
	});
	app.ticker.add(function(deltaz) {
		count -= 0.1;
		displacementSprite.y = count * 10;
		blurFilter.blur = count * -0.3;
		var degrees = 0;
		var toAdd = 0;
		if (count == -4.5){
			count = 0;
		}
		if(count < -2.8 && count > -4.5){
			degrees = -(count * 4 + 3).toString() + "deg";
		}
		else {		
			degrees = (count * 4).toString() + "deg";
		}
		if(count > -2){
			toAdd++;
		}
		else {
			toAdd = 0;	
		}
		
		//avatar motion
		for (player in players){
			if(document.getElementById(player) != null ){
				var thePlayer = document.getElementById(player);
				var thePlayerName = document.getElementById(player + "name");
				var oldX = parseInt(thePlayer.style.left.replace("px", ""));
				var oldY = parseInt(thePlayer.style.top.replace("px", ""));
				var newX = parseInt(players[player][2].replace("px", ""));
				var newY = parseInt(players[player][3].replace("px", ""));
				var charRight = players[player][0];
				var charLeft = players[player][1];
				//var ratio = (newY - oldY) / (newX - oldX);
				if(oldX != newX){
					if(newX > oldX){
						if(newX - 1 > oldX){
							oldX += 2;
							thePlayerName.style.left = (parseInt((thePlayerName.style.left).replace("px", "")) + 2).toString() + "px";
						}
						else if(newX - 1 == oldX){
							oldX++
							thePlayerName.style.left = (parseInt((thePlayerName.style.left).replace("px", "")) + 1).toString() + "px";
						}
						thePlayer.innerHTML = charRight;
					}
					else if (newX < oldX){
						if(newX + 1 < oldX){
							oldX -= 2;
							thePlayerName.style.left = (parseInt((thePlayerName.style.left).replace("px", "")) - 2).toString() + "px";
						}
						else if (newX + 1 == oldX){
							oldX--;
							thePlayerName.style.left = (parseInt((thePlayerName.style.left).replace("px", "")) - 1).toString() + "px";
						}
						thePlayer.innerHTML = charLeft;
					}
					thePlayer.style.left = oldX.toString() + "px";
				}
				if(oldY != newY){
					if(newY > oldY){
						if(newY - 1 > oldY){
							oldY += 2;
							thePlayerName.style.top = (parseInt((thePlayerName.style.top).replace("px", "")) + 2).toString() + "px";
						}
						else if(newY - 1 == oldY){
							oldY++
							thePlayerName.style.top = (parseInt((thePlayerName.style.top).replace("px", "")) + 1).toString() + "px";
						}
					}
					else if (newY < oldY){
						if(newY + 1 < oldY){
							oldY -= 2;
							thePlayerName.style.top = (parseInt((thePlayerName.style.top).replace("px", "")) - 2).toString() + "px";
						}
						else if (newY + 1 == oldY){
							oldY--;
							thePlayerName.style.top = (parseInt((thePlayerName.style.top).replace("px", "")) - 1).toString() + "px";
						}
					}
					thePlayer.style.top = oldY.toString() + "px";
				}
			}
		}
		//girl motion
		if(document.getElementById("girlArms").style.visibility == 'visible'){
			var girlArmMotion = (toAdd + parseInt($("#girlPushArms").css('left').replace("px", ""))).toString() + "px";
			$("#girlPushArms").css({'left': girlArmMotion});
			var girlBodyMotion = (toAdd + parseInt($("#girlPushBody").css('left').replace("px", ""))).toString() + "px";
			$("#girlPushBody").css({'left': girlArmMotion});
			if(motionTime == true){
				var formMotion = (toAdd + parseInt($("#form").css('left').replace("px", ""))).toString() + "px";
				$("#form").css({'left': formMotion});
			}
		}
		//skew
		$("#girlPushBody").css({'-ms-transform': 'skewX(' + degrees + ')', '-webkit-transform': 'skewX(' + degrees + ')', 'transform': 'skewX(' + degrees + ')'});
	});
	if( document.getElementById(userId) != null && document.getElementById(userId) != undefined ){
		setInterval(function(){	
			socket.emit("blinkInterval", userId);
		}, 3000);
	}
	socket.on("blinkResponse", function(id){
		if(document.getElementById(id) != null){
			var blink = document.getElementById(id).querySelectorAll(".blink")[0];
			blink.style.visibility = "visible";
			setTimeout(function(){
				blink.style.visibility = "hidden";
			}, 100);
		}
	});
	/*document.getElementById("playersDiv").innerHTML += '<div class="player"><div class="' + userId + '" id="' + userId + '" style="position: absolute; top: 0px + ; left: 0px;" alt="player">' + players[player][0] + '</div><div style="position: absolute; left: ' + (parseInt(players[player][2].replace("px", "")) - 50).toString() + 'px; top: ' + (parseInt(players[player][3].replace("px", "")) + 259).toString() + 'px; webkit-transform: scale(0.45); -ms-transform: scale(0.45); transform: scale(0.45);" id="' + player + 'name"><font color="white" size="23px">' + players[player][4] + '</font><br><div id="' + player + 'afk" style="visibility: hidden; position: relative; left: 35px;"><font size="18" color="silver">(afk)</font></div></div></div></div>';*/
	socket.emit("id", userId, right, left, name, "0px", "0px");
	//here
	socket.on('players', function(player2, numPlyr){
		var beforePlayers = false;
		var afterPlayers = false;
		for(player1 in player2){
			if(player1[4] == "Erintuitive"){
				beforePlayers = true;
			}
		}
		players = player2;
		for(player1 in players){
			if(player1[4] == "Erintuitive"){
				afterPlayers = true;
			}
		}
		if(name == "Erintuitive" && beforePlayers == afterPlayers && numPlyr > 1){
			alert("Erintuitive, a person has entered your chatroom!");
		}
		for(player in players) {
			if(document.getElementById(player) == null || document.getElementById(player) == undefined){
				document.getElementById("playersDiv").innerHTML += '<div class="player"><div class="' + player + '" id="' + player + '" style="position: absolute; top: ' + players[player][3] + '; left: ' + players[player][2] + ';" alt="player">' + players[player][0] + '</div><div style="position: absolute; left: ' + (parseInt(players[player][2].replace("px", "")) - 50).toString() + 'px; top: ' + (parseInt(players[player][3].replace("px", "")) + 259).toString() + 'px; webkit-transform: scale(0.45); -ms-transform: scale(0.45); transform: scale(0.45);" id="' + player + 'name"><font color="white" size="23px">' + players[player][4] + '</font><br><div id="' + player + 'afk" style="visibility: hidden; position: relative; left: 35px;"><font size="18" color="silver">(afk)</font></div></div></div></div>';
			}
			/*else {
				var x = parseInt(players[player][1].replace("px", ""));
				var y = parseInt(players[player][2].replace("px", ""));
				var playerParent = document.getElementById(player).parentElement;
				TweenMax.to(playerParent, 2, {left: x, top: y});
			}*/
		}
	});
</script>
</body>
</html>